<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">

  <h:body>
    <ui:composition template="../templates/super_template.xhtml">
      <ui:define name="main-body">
        <h:form id="form-main-data">          

          <p:tabView id="tabview" dynamic="true" cache="false" effect="drop" effectDuration="fast">

            <p:tab title="Solicitudes Pendientes" id="tab1">

              <p:dataTable id="table-solicitudes-pendientes" var="solicitud" value="#{solicitudBean.listaSolicitudesPendientes}" rowKey="#{solicitud}"
                           paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                           editable="true"  paginator="true" rows="20"   rowsPerPageTemplate="20,30,40,50,100,1000"
                           widgetVar="solicitudPendienteTable"  emptyMessage="No se encontraron solicitudes pendientes." >

                <p:ajax oncomplete="cmdRefreshSolicitudes()" event="rowEdit" listener="#{solicitudBean.onRowEdit}"/>
                <p:ajax event="rowEditCancel" listener="#{solicitudBean.onRowCancel}" />

                <p:column headerText="ID" sortBy="#{solicitud.id}" width="40">  
                  <h:outputText value="#{solicitud.id}" />
                </p:column>
                
                <p:column width="80" filterBy="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" sortBy="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" headerText="Origen" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" /></f:facet>
                    <f:facet name="input">                  
                      <p:selectOneMenu filter="true" filterMatchMode="contains" id="origen" value="#{solicitud.distanciaById.localidadByIdOrigen.id}" style="width: 100%;">
                        <f:selectItems value="#{solicitudBean.listaLocalidades}" />                    
                      </p:selectOneMenu>
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column width="80" filterBy="#{solicitud.distanciaById.localidadByIdDestino.nombre}" sortBy="#{solicitud.distanciaById.localidadByIdDestino.nombre}" headerText="Destino" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{solicitud.distanciaById.localidadByIdDestino.nombre}" /></f:facet>
                    <f:facet name="input">                  
                      <p:selectOneMenu filter="true" filterMatchMode="contains" id="destino" value="#{solicitud.distanciaById.localidadByIdDestino.id}" style="width: 100%;">
                        <f:selectItems value="#{solicitudBean.listaLocalidades}" />                    
                      </p:selectOneMenu>
                    </f:facet>
                  </p:cellEditor>
                </p:column>
                
                <p:column headerText="Distancia" width="70">  
                  <h:outputText value="#{solicitud.distanciaById.distancia}" />
                </p:column>

                <p:column filterBy="#{solicitud.FSalida}" sortBy="#{solicitud.FSalida}" headerText="F Salida"> 
                  
                  <p:cellEditor>
                    <f:facet name="output">
                      <h:outputText value="#{solicitud.FSalida}">
                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                      </h:outputText>
                    </f:facet>
                    <f:facet name="input"> 
                      <p:calendar id="fsalida" value="#{solicitud.FSalida}" pattern="MM/dd/yyyy HH:mm" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{solicitud.FLlegada}" sortBy="#{solicitud.FLlegada}" headerText="F Llegada">  
                  
                  <p:cellEditor>
                    <f:facet name="output">
                      <h:outputText value="#{solicitud.FLlegada}">
                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                      </h:outputText>
                    </f:facet>
                    <f:facet name="input"> 
                      <p:calendar id="fllegada" value="#{solicitud.FLlegada}" pattern="MM/dd/yyyy HH:mm" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{solicitud.hospedaje}"  headerText="Hospedaje" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{solicitud.hospedaje}" /></f:facet>
                    <f:facet name="input">
                      <p:inputTextarea id="hospedaje" value="#{solicitud.hospedaje}" style="width:100%">
                        <f:validateLength minimum="7" />
                        <p:ajax update="msgHospedaje" event="blur" />
                      </p:inputTextarea>                
                      <p:message for="hospedaje" id="msgHospedaje" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{solicitud.novedades}"  headerText="Novedades" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{solicitud.novedades}" /></f:facet>
                    <f:facet name="input">
                      <p:inputTextarea id="novedades" value="#{solicitud.novedades}" style="width:100%">
                        <f:validateLength minimum="7" />
                        <p:ajax update="msgNovedades" event="blur" />
                      </p:inputTextarea>                
                      <p:message for="novedades" id="msgNovedades" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column headerText="Estado" >  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{solicitud.estado_legible}" /></f:facet>
                    <f:facet name="input"><p:selectBooleanCheckbox value="#{solicitud.estado}" style="margin-left: 45%" /></f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{solicitud.usuarioByIdUsuarioConductor.apellido}" sortBy="#{solicitud.usuarioByIdUsuarioConductor.apellido}" headerText="Conductor" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output">
                      <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor.apellido}" />
                      <p:spacer width="5"/>
                      <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor.nombre}" />
                    </f:facet>
                    <f:facet name="input">                  
                      <p:selectOneMenu filter="true" filterMatchMode="contains" id="conductor" value="#{solicitud.usuarioByIdUsuarioConductor.id}" style="width: 100%;">
                        <f:selectItems value="#{solicitudBean.listaConductores}" />                    
                      </p:selectOneMenu>
                    </f:facet>
                  </p:cellEditor>
                </p:column>
                
                <p:column width="75" filterBy="#{solicitud.usuarioByIdUsuarioSolicita.apellido}" sortBy="#{solicitud.usuarioByIdUsuarioSolicita.apellido}" headerText="Solicitado por:" filterMatchMode="contains">  
                  <h:outputText value="#{solicitud.usuarioByIdUsuarioSolicita.apellido}" />
                      <p:spacer width="5"/>
                      <h:outputText value="#{solicitud.usuarioByIdUsuarioSolicita.nombre}" />
                </p:column>
                
                <p:column width="75" filterBy="#{solicitud.FCreacion}" sortBy="#{solicitud.FCreacion}" headerText="F Creado">  
                  <h:outputText value="#{solicitud.FCreacion}">
                    <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                  </h:outputText>
                </p:column>

                <p:column style="width:50px"> 
                  <p:rowEditor id="editrow" /> 
                </p:column> 
              </p:dataTable>  

            </p:tab>
            
            <!-- __________TAB 2__________ -->
            
            <p:tab title="Solicitudes Aprobadas" id="tab2">

              <p:dataTable id="table-solicitudes-aprobadas" var="solicitud" value="#{solicitudBean.listaSolicitudesAprobadas}" rowKey="#{solicitud}"
                           paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                           editable="true"  paginator="true" rows="20"   rowsPerPageTemplate="20,30,40,50,100,1000"
                           widgetVar="solicitudAprobadaTable"  emptyMessage="No se encontraron datos." >

                <p:ajax event="rowEdit" listener="#{solicitudBean.onRowEdit}" oncomplete="cmdRefreshSolicitudes()"/>
                <p:ajax event="rowEditCancel" listener="#{solicitudBean.onRowCancel}" />

                <p:column headerText="ID" sortBy="#{solicitud.id}" width="40">  
                  <h:outputText value="#{solicitud.id}" />
                </p:column>
                
                <p:column width="80" filterBy="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" sortBy="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" headerText="Origen" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" /></f:facet>
                    <f:facet name="input">                  
                      <p:selectOneMenu filter="true" filterMatchMode="contains" id="origen" value="#{solicitud.distanciaById.localidadByIdOrigen.id}" style="width: 100%;">
                        <f:selectItems value="#{solicitudBean.listaLocalidades}" />                    
                      </p:selectOneMenu>
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column width="80" filterBy="#{solicitud.distanciaById.localidadByIdDestino.nombre}" sortBy="#{solicitud.distanciaById.localidadByIdDestino.nombre}" headerText="Destino" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{solicitud.distanciaById.localidadByIdDestino.nombre}" /></f:facet>
                    <f:facet name="input">                  
                      <p:selectOneMenu filter="true" filterMatchMode="contains" id="destino" value="#{solicitud.distanciaById.localidadByIdDestino.id}" style="width: 100%;">
                        <f:selectItems value="#{solicitudBean.listaLocalidades}" />                    
                      </p:selectOneMenu>
                    </f:facet>
                  </p:cellEditor>
                </p:column>
                
                <p:column headerText="Distancia" width="70">  
                  <h:outputText value="#{solicitud.distanciaById.distancia}" />
                </p:column>

                <p:column filterBy="#{solicitud.FSalida}" sortBy="#{solicitud.FSalida}" headerText="F Salida"> 
                  
                  <p:cellEditor>
                    <f:facet name="output">
                      <h:outputText value="#{solicitud.FSalida}">
                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                      </h:outputText>
                    </f:facet>
                    <f:facet name="input"> 
                      <p:calendar id="fsalida" value="#{solicitud.FSalida}" pattern="MM/dd/yyyy HH:mm" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{solicitud.FLlegada}" sortBy="#{solicitud.FLlegada}" headerText="F Llegada">  
                  
                  <p:cellEditor>
                    <f:facet name="output">
                      <h:outputText value="#{solicitud.FLlegada}">
                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                      </h:outputText>
                    </f:facet>
                    <f:facet name="input"> 
                      <p:calendar id="fllegada" value="#{solicitud.FLlegada}" pattern="MM/dd/yyyy HH:mm" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{solicitud.hospedaje}"  headerText="Hospedaje" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{solicitud.hospedaje}" /></f:facet>
                    <f:facet name="input">
                      <p:inputTextarea id="hospedaje" value="#{solicitud.hospedaje}" style="width:100%">
                        <f:validateLength minimum="7" />
                        <p:ajax update="msgHospedaje" event="blur" />
                      </p:inputTextarea>                
                      <p:message for="hospedaje" id="msgHospedaje" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{solicitud.novedades}"  headerText="Novedades" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{solicitud.novedades}" /></f:facet>
                    <f:facet name="input">
                      <p:inputTextarea id="novedades" value="#{solicitud.novedades}" style="width:100%">
                        <f:validateLength minimum="7" />
                        <p:ajax update="msgNovedades" event="blur" />
                      </p:inputTextarea>                
                      <p:message for="novedades" id="msgNovedades" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column headerText="Estado" >  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{solicitud.estado_legible}" /></f:facet>
                    <f:facet name="input"><p:selectBooleanCheckbox value="#{solicitud.estado}" style="margin-left: 45%" /></f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{solicitud.usuarioByIdUsuarioConductor.apellido}" sortBy="#{solicitud.usuarioByIdUsuarioConductor.apellido}" headerText="Conductor" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output">
                      <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor.apellido}" />
                      <p:spacer width="5"/>
                      <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor.nombre}" />
                    </f:facet>
                    <f:facet name="input">                  
                      <p:selectOneMenu filter="true" filterMatchMode="contains" id="conductor" value="#{solicitud.usuarioByIdUsuarioConductor.id}" style="width: 100%;">
                        <f:selectItems value="#{solicitudBean.listaConductores}" />                    
                      </p:selectOneMenu>
                    </f:facet>
                  </p:cellEditor>
                </p:column>
                
                <p:column width="75" filterBy="#{solicitud.usuarioByIdUsuarioSolicita.apellido}" sortBy="#{solicitud.usuarioByIdUsuarioSolicita.apellido}" headerText="Solicitado por:" filterMatchMode="contains">  
                  <h:outputText value="#{solicitud.usuarioByIdUsuarioSolicita.apellido}" />
                      <p:spacer width="5"/>
                      <h:outputText value="#{solicitud.usuarioByIdUsuarioSolicita.nombre}" />
                </p:column>
                
                <p:column width="75" filterBy="#{solicitud.FCreacion}" sortBy="#{solicitud.FCreacion}" headerText="F Creado">  
                  <h:outputText value="#{solicitud.FCreacion}">
                    <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                  </h:outputText>
                </p:column>

                <p:column style="width:50px"> 
                  <p:rowEditor id="editrow" /> 
                </p:column> 
              </p:dataTable>  

            </p:tab>

            <!-- __________TAB 3__________ -->

            <p:tab title="Localidades" id="tab3">
              <p:layout  >
                <p:layoutUnit id="origen-wrapper" position="west" size="600" header="LISTA CIUDAD DE ORIGEN (Seleccione una ciudad dando Click en el ID)" resizable="true" >

                  <p:dataTable selection="#{localidadBean.localidadSeleccionada}" selectionMode="single" id="table-localidades" var="localidad" value="#{localidadBean.listaLocalidades}" rowKey="#{localidad.id}"                               
                               editable="true" widgetVar="localidadTable"  emptyMessage="No se encontraron datos." >

                    <p:ajax event="rowEdit" listener="#{localidadBean.onRowEdit}" oncomplete="cmdRefreshSolicitudes()"/>
                    <p:ajax event="rowEditCancel" listener="#{localidadBean.onRowCancel}" />                    
                    <p:ajax event="rowSelect" listener="#{localidadBean.onRowSelect}" onsuccess="cmdRefreshSolicitudes()" /> 

                    <p:column headerText="ID" width="50">  
                      <h:outputText value="#{localidad.id}" />
                    </p:column>

                    <p:column headerText="Nombre">  
                      <p:cellEditor>
                        <f:facet name="output"><h:outputText value="#{localidad.nombre}" /></f:facet>
                        <f:facet name="input">
                          <p:inputText id="loc_nombre" value="#{localidad.nombre}" style="width:100%" required="true">                        
                            <p:ajax update="msgLoc_nombre" event="blur" />
                          </p:inputText>                
                          <p:message for="loc_nombre" id="msgLoc_nombre" display="icon" />
                        </f:facet>
                      </p:cellEditor>
                    </p:column>

                    <p:column style="width:50px">                   
                      <p:rowEditor id="editrow" /> 
                    </p:column> 
                  </p:dataTable>  
                </p:layoutUnit>
                <p:layoutUnit id="destino-wrapper" position="center" header="EDITAR DISTANCIA DESTINO (Click en la distancia actual para Editar y terminar con Enter.)">
                  <p:dataTable id="table-distancias" var="distancia" value="#{localidadBean.listaEditarDistancia}" rowKey="#{localidad.id}"
                               editable="true" editMode="cell" widgetVar="distanciaTable"  emptyMessage="Seleccione una ciudad haciendo Click en el ID." >
                    
                    <p:ajax event="cellEdit" listener="#{localidadBean.onCellEdit}"/>
                    
                    <p:column headerText="Nombre">  
                      <h:outputText value="#{distancia.nombre}" />
                    </p:column>
                    
                    <p:column headerText="Distancia" > 
                      <p:cellEditor>
                        <f:facet name="output">
                          <h:outputText value="#{distancia.distancia}" />
                        </f:facet>
                        <f:facet name="input">
                          <p:inputText value="#{distancia.distancia}" />                             
                        </f:facet>
                      </p:cellEditor>
                    </p:column>
                    

                  </p:dataTable>
                </p:layoutUnit>
              </p:layout>

            </p:tab>

            <!-- __________TAB 4__________ -->

            <p:tab title="Usuarios" id="tab4">
              <p:dataTable resizableColumns="true" id="table-usuarios" var="usuario" value="#{usuarioBean.listaUsuarios}" rowKey="#{usuario}"
                           paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                           editable="true"  paginator="true" rows="10"   rowsPerPageTemplate="10,20,30,40,50,100,1000"
                           widgetVar="usuariosTable"  emptyMessage="No se encontraron datos." >  

                <p:ajax event="rowEdit" listener="#{usuarioBean.onRowEdit}" oncomplete="cmdRefreshSolicitudes()"/>
                <p:ajax event="rowEditCancel" listener="#{usuarioBean.onRowCancel}" />

                <p:column filterBy="#{usuario.codemp}" headerText="Cod.Empleado" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.codemp}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="codemp" value="#{usuario.codemp}" required="true" requiredMessage="El codigo de empleado es obligatorio." style="width:100%">
                        <f:validateLength minimum="2" />
                        <p:ajax update="msgCodemp" event="blur" />
                      </p:inputText>                
                      <p:message for="codemp" id="msgCodemp" display="icon" />                  
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{usuario.codapr}" headerText="Cod. Aprobador" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.codapr}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="codapr" value="#{usuarioBean.usuario.codapr}" required="false" style="width:100%">
                      </p:inputText>                
                      <p:message for="codapr" id="msgCodapr" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{usuario.apellido}" sortBy="#{usuario.apellido}" headerText="Apellidos" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.apellido}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="apellido" value="#{usuario.apellido}" required="true" requiredMessage="El apellido es obligatorio." style="width: 100%;">
                        <f:validateLength minimum="2" />
                        <p:ajax update="msgApellido" event="blur" />
                      </p:inputText>                
                      <p:message for="apellido" id="msgApellido" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{usuario.nombre}" sortBy="#{usuario.nombre}"  headerText="Nombres" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.nombre}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="nombre" value="#{usuario.nombre}" required="true" requiredMessage="La nombre es obligatorio." style="width:100%">
                        <f:validateLength minimum="2" />
                        <p:ajax update="msgNombre" event="blur" />
                      </p:inputText>                
                      <p:message for="nombre" id="msgNombre" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{usuario.cedula}"  headerText="Cédula" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.cedula}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="cedula" value="#{usuario.cedula}" required="true" requiredMessage="La cédula es obligatoria." style="width:100%">
                        <f:validateLength minimum="10" />
                        <p:ajax update="msgCedula" event="blur" />
                      </p:inputText>                
                      <p:message for="cedula" id="msgCedula" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column headerText="Clave">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.clave}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="clave" value="#{usuario.clave}" required="true" requiredMessage="La clave es obligatoria." style="width:100%">
                        <f:validateLength minimum="5" />
                        <p:ajax update="msgClave" event="blur" />
                      </p:inputText>
                      <p:message for="clave" id="msgClave" showSummary="true" showDetail="false" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{usuario.email}"  headerText="Email" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.email}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="email" value="#{usuario.email}" style="width:100%">
                      </p:inputText>                
                      <p:message for="email" id="msgEmail" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{usuario.telefono}"  headerText="Telefono" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.telefono}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="telefono" value="#{usuario.telefono}" style="width:100%"/>
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{usuario.movil}"  headerText="Movil" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.movil}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="movil" value="#{usuario.movil}" required="false" style="width:100%"/>                      
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column sortBy="#{usuario.rol_legible}" headerText="Rol" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.rol_legible}" />
                    </f:facet>
                    <f:facet name="input">
                      <p:selectOneRadio id="rol" value="#{usuario.rol}" required="true" requiredMessage="El rol es obligatorio.">
                        <f:selectItems value="#{usuarioBean.tipos_rol}"/>
                      </p:selectOneRadio>
                    </f:facet>
                  </p:cellEditor>              
                </p:column>

                <p:column headerText="Estado" sortBy="#{usuario.estado_legible}">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.estado_legible}" /></f:facet>
                    <f:facet name="input"><p:selectBooleanCheckbox value="#{usuario.estado}" style="margin-left: 45%" /></f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column style="width:50px"> 
                  <p:rowEditor id="editrow" /> 
                </p:column>          
              </p:dataTable>  
            </p:tab>

            <!-- __________TAB 5__________ -->

            <p:tab title="Conductores" id="tab5">
              <p:dataTable id="table-conductores" var="usuario" value="#{usuarioBean.listaConductores}" rowKey="#{usuario}"
                           paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                           editable="true"  paginator="true" rows="10"   rowsPerPageTemplate="10,20,30,40,50,100,1000"
                           widgetVar="usuariosTable" emptyMessage="No se encontraron datos." >  

                <p:ajax event="rowEdit" listener="#{usuarioBean.onRowEdit}" oncomplete="cmdRefreshSolicitudes()" />
                <p:ajax event="rowEditCancel" listener="#{usuarioBean.onRowCancel}" />

                <p:column filterBy="#{usuario.apellido}" sortBy="#{usuario.apellido}" headerText="Apellidos" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.apellido}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="apellido" value="#{usuario.apellido}" required="true" requiredMessage="El apellido es obligatorio." style="width: 100%;">
                        <f:validateLength minimum="2" />
                        <p:ajax update="msgApellido" event="blur" />
                      </p:inputText>                
                      <p:message for="apellido" id="msgApellido" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{usuario.nombre}" sortBy="#{usuario.nombre}"  headerText="Nombres" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.nombre}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="nombre" value="#{usuario.nombre}" required="true" requiredMessage="La nombre es obligatorio." style="width:100%">
                        <f:validateLength minimum="2" />
                        <p:ajax update="msgNombre" event="blur" />
                      </p:inputText>                
                      <p:message for="nombre" id="msgNombre" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{usuario.cedula}"  headerText="Cédula" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.cedula}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="cedula" value="#{usuario.cedula}" required="true" requiredMessage="La cédula es obligatoria." style="width:100%">
                        <f:validateLength minimum="10" />
                        <p:ajax update="msgCedula" event="blur" />
                      </p:inputText>                
                      <p:message for="cedula" id="msgCedula" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{usuario.email}"  headerText="Email" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.email}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="email" value="#{usuario.email}" style="width:100%">
                      </p:inputText>                
                      <p:message for="email" id="msgEmail" display="icon" />
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{usuario.telefono}"  headerText="Telefono" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.telefono}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="telefono" value="#{usuario.telefono}" style="width:100%"/>
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column filterBy="#{usuario.movil}"  headerText="Movil" filterMatchMode="contains">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.movil}" /></f:facet>
                    <f:facet name="input">
                      <p:inputText id="movil" value="#{usuario.movil}" required="false" style="width:100%"/>                      
                    </f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column headerText="Estado" sortBy="#{usuario.estado_legible}">  
                  <p:cellEditor>
                    <f:facet name="output"><h:outputText value="#{usuario.estado_legible}" /></f:facet>
                    <f:facet name="input"><p:selectBooleanCheckbox value="#{usuario.estado}" style="margin-left: 45%" /></f:facet>
                  </p:cellEditor>
                </p:column>

                <p:column style="width:50px">               
                  <p:rowEditor id="editrow" />              
                </p:column>          
              </p:dataTable>  
            </p:tab>

          </p:tabView>
        </h:form>  

        <!-- ________________________   NEW SOLICITUD FORM  ________________________   -->

        <p:dialog dynamic="true" widgetVar="newSolicitud" header="Ingrese los datos de la Nueva Solicitud"  closeOnEscape="true" draggable="false" resizable="false" showEffect="drop" hideEffect="drop">
          <h:form id="form-new-solicitud">          
            <center>
              <p:panel id="pn2" style="margin-bottom:10px;">
                <p:messages id="messages" />
                <h:panelGrid id="grid" columns="3" cellpadding="5">

                  <h:outputLabel for="origen" value="Origen: *" />
                  <p:selectOneMenu filter="true" filterMatchMode="contains" id="origen" value="#{solicitudBean.solicitud.distanciaById.localidadByIdOrigen.id}" style="width: 100%;">
                    <f:selectItems value="#{solicitudBean.listaLocalidades}" />                    
                  </p:selectOneMenu>
                  <br></br>

                  <h:outputLabel for="destino" value="Destino: *" />
                  <p:selectOneMenu filter="true" filterMatchMode="contains" id="destino" value="#{solicitudBean.solicitud.distanciaById.localidadByIdDestino.id}" style="width: 100%;">
                    <f:selectItems value="#{solicitudBean.listaLocalidades}" />                    
                  </p:selectOneMenu>
                  <br></br>

                  <h:outputLabel for="fsalida" value="Fecha Salida: *" />
                  <p:calendar id="fsalida" value="#{solicitudBean.solicitud.FSalida}" pattern="MM/dd/yyyy HH:mm" />
                  <br></br>

                  <h:outputLabel for="fllegada" value="Fecha Llegada: *" />
                  <p:calendar id="fllegada" value="#{solicitudBean.solicitud.FLlegada}" pattern="MM/dd/yyyy HH:mm" />
                  <br></br>

                  <h:outputLabel for="hospedaje" value="Hospedaje: " />
                  <p:inputTextarea id="hospedaje" value="#{solicitudBean.solicitud.hospedaje}" style="width:100%">
                  </p:inputTextarea>                
                  <p:message for="hospedaje" id="msgHospedaje" display="icon" />

                  <h:outputLabel for="novedades" value="Novedades: " />
                  <p:inputTextarea id="novedades" value="#{solicitudBean.solicitud.novedades}" style="width:100%">
                  </p:inputTextarea>                
                  <p:message for="novedades" id="msgNovedades" display="icon" />

                  <h:outputLabel for="conductor" value="Conductor: *" />
                  <p:selectOneMenu filter="true" filterMatchMode="contains" id="conductor" value="#{solicitudBean.solicitud.usuarioByIdUsuarioConductor.id}" style="width: 100%;">
                    <f:selectItems value="#{solicitudBean.listaConductores}" />
                  </p:selectOneMenu>
                  <br></br>

                </h:panelGrid>
                <f:facet name="footer">
                  <center>
                    <p:commandButton ajax="true" oncomplete="cmdRefreshSolicitudes()" validateClient="true" value="Guardar" onclick="PF('newSolicitud').hide();"  action="#{solicitudBean.saveSolicitud()}" />
                  </center>
                </f:facet> 
              </p:panel>
            </center>
          </h:form>
        </p:dialog>

        <!-- ________________________   NEW LOCALIDAD FORM  ________________________   -->

        <p:dialog dynamic="true" widgetVar="newLocalidad" header="Ingrese los datos de la Nueva Localidad"  closeOnEscape="true" draggable="false" resizable="false" showEffect="drop" hideEffect="drop">
          <h:form id="form-new-localidad">          
            <center>
              <p:panel id="pn2" style="margin-bottom:10px;">
                <h:panelGrid id="grid2" columns="3" cellpadding="5">

                  <h:outputLabel for="loc_nombre" value="Nombre *" />
                  <p:inputText id="loc_nombre" value="#{localidadBean.localidad.nombre}" style="width:100%" required="true">                    
                    <p:ajax update="msgLoc_nombre" event="blur" />
                  </p:inputText>                
                  <p:message for="loc_nombre" id="msgLoc_nombre" display="icon" />

                </h:panelGrid>
                <f:facet name="footer">
                  <center>
                    <p:commandButton ajax="true" oncomplete="cmdRefreshSolicitudes()" validateClient="true" value="Guardar" onclick="PF('newLocalidad').hide();"  action="#{localidadBean.saveLocalidad()}" />
                  </center>
                </f:facet> 
              </p:panel>
            </center>
          </h:form>
        </p:dialog>


        <!-- ________________________   NEW USUARIO FORM  ________________________   -->


        <p:dialog dynamic="true" widgetVar="newUsuario" header="Ingrese los datos del Nuevo Usuario"  closeOnEscape="true" draggable="false" resizable="false" showEffect="drop" hideEffect="drop">
          <h:form id="form-new-usuario">          
            <center>
              <p:panel id="pn3" style="margin-bottom:10px;">
                <p:messages id="messages" />
                <h:panelGrid id="grid" columns="3" cellpadding="5">

                  <h:outputLabel for="codemp" value="Cod. Empleado: *" />
                  <p:inputText id="codemp" value="#{usuarioBean.usuario.codemp}" required="true" requiredMessage="El codigo de empleado es obligatorio." style="width:100%">
                    <f:validateLength minimum="2" />
                    <p:ajax update="msgCodemp" event="blur" />
                  </p:inputText>                
                  <p:message for="codemp" id="msgCodemp" display="icon" />

                  <h:outputLabel for="codapr" value="Cod. Aprobador:" />
                  <p:inputText id="codapr" value="#{usuarioBean.usuario.codapr}" required="false" style="width:100%">
                  </p:inputText>                
                  <p:message for="codapr" id="msgCodapr" display="icon" />

                  <h:outputLabel for="apellido" value="Apellido: *" />
                  <p:inputText id="apellido" value="#{usuarioBean.usuario.apellido}" required="true" requiredMessage="El apellido es obligatorio." style="width:100%">
                    <f:validateLength minimum="2" />
                    <p:ajax update="msgApellido" event="blur" />
                  </p:inputText>                
                  <p:message for="apellido" id="msgApellido" display="icon" />

                  <h:outputLabel for="nombre" value="Nombre: *" />
                  <p:inputText id="nombre" value="#{usuarioBean.usuario.nombre}" required="true" requiredMessage="El nombre es obligatorio." style="width:100%">
                    <f:validateLength minimum="2" />
                    <p:ajax update="msgNombre" event="blur" />
                  </p:inputText>                
                  <p:message for="nombre" id="msgNombre" display="icon" />

                  <h:outputLabel for="cedula" value="Cédula: *" />
                  <p:inputText id="cedula" value="#{usuarioBean.usuario.cedula}" required="true" requiredMessage="La cédula es obligatoria." style="width:100%">
                    <f:validateLength minimum="10" />
                    <p:ajax update="msgCedula" event="blur" />
                  </p:inputText>                
                  <p:message for="cedula" id="msgCedula" display="icon" />

                  <h:outputLabel for="clave" value="Clave: *" />
                  <p:inputText id="clave" value="#{usuarioBean.usuario.clave}" required="true" requiredMessage="La clave es obligatoria." style="width:100%">
                    <f:validateLength minimum="5" />
                    <p:ajax update="msgClave" event="blur" />
                  </p:inputText>                
                  <p:message for="clave" id="msgClave" display="icon" />

                  <h:outputLabel for="email" value="Email: " />
                  <p:inputText id="email" value="#{usuarioBean.usuario.email}" required="false" style="width:100%">
                  </p:inputText>                
                  <p:message for="email" id="msgEmail" display="icon" />

                  <h:outputLabel for="telefono" value="Teléfono: " />
                  <p:inputText id="telefono" value="#{usuarioBean.usuario.telefono}" required="false" style="width:100%">                    
                  </p:inputText>                
                  <p:message for="telefono" id="msgTelefono" display="icon" />

                  <h:outputLabel for="movil" value="Movil: " />
                  <p:inputText id="movil" value="#{usuarioBean.usuario.movil}" required="false" style="width:100%">
                  </p:inputText>                
                  <p:message for="movil" id="msgMovil" display="icon" />

                  <p:outputLabel for="rol" value="Rol:" />
                  <p:selectOneRadio id="rol" value="#{usuarioBean.usuario.rol}" required="true" requiredMessage="El rol es obligatorio." style="width:100%">
                    <f:selectItems value="#{usuarioBean.tipos_rol}" />
                    <p:ajax update="msgRol" event="change" />
                  </p:selectOneRadio>
                  <p:message for="rol" id="msgRol" display="icon" />

                  <h:outputLabel value="Estado: " />
                  <p:selectBooleanCheckbox id="estado" value="#{usuarioBean.usuario.estado}" />
                  <p:message for="estado" id="msgEstado" display="icon" />

                </h:panelGrid>
                <f:facet name="footer">
                  <center>
                    <p:commandButton ajax="true" oncomplete="cmdRefreshSolicitudes()" validateClient="true" value="Guardar" onclick="PF('newUsuario').hide();"  action="#{usuarioBean.saveUsuario()}" />
                  </center>
                </f:facet> 
              </p:panel>
            </center>
          </h:form>
        </p:dialog>

        <!-- ________________________   NEW CONDUCTOR FORM  ________________________   -->

        <p:dialog dynamic="true" widgetVar="newConductor" header="Ingrese los datos del Nuevo Conductor"  closeOnEscape="true" draggable="false" resizable="false" showEffect="drop" hideEffect="drop">
          <h:form id="form-new-conductor">          
            <center>
              <p:panel id="pnl" style="margin-bottom:10px;">
                <p:messages id="messages" />
                <h:panelGrid id="grid" columns="3" cellpadding="5">
                  <h:outputLabel for="apellido" value="Apellido: *" />
                  <p:inputText id="apellido" value="#{usuarioBean.conductor.apellido}" required="true" requiredMessage="El apellido es obligatorio." style="width:100%">
                    <f:validateLength minimum="2" />
                    <p:ajax update="msgApellido" event="blur" />
                  </p:inputText>                
                  <p:message for="apellido" id="msgApellido" display="icon" />

                  <h:outputLabel for="nombre" value="Nombre: *" />
                  <p:inputText id="nombre" value="#{usuarioBean.conductor.nombre}" required="true" requiredMessage="El nombre es obligatorio." style="width:100%">
                    <f:validateLength minimum="2" />
                    <p:ajax update="msgNombre" event="blur" />
                  </p:inputText>                
                  <p:message for="nombre" id="msgNombre" display="icon" />

                  <h:outputLabel for="cedula" value="Cédula: *" />
                  <p:inputText id="cedula" value="#{usuarioBean.conductor.cedula}" required="true" requiredMessage="La cédula es obligatoria." style="width:100%">
                    <f:validateLength minimum="10" />
                    <p:ajax update="msgCedula" event="blur" />
                  </p:inputText>                
                  <p:message for="cedula" id="msgCedula" display="icon" />

                  <h:outputLabel for="email" value="Email: " />
                  <p:inputText id="email" value="#{usuarioBean.usuario.email}" required="false" style="width:100%">
                  </p:inputText>                
                  <p:message for="email" id="msgEmail" display="icon" />

                  <h:outputLabel for="telefono" value="Teléfono: " />
                  <p:inputText id="telefono" value="#{usuarioBean.usuario.telefono}" required="false" style="width:100%">                    
                  </p:inputText>                
                  <p:message for="telefono" id="msgTelefono" display="icon" />

                  <h:outputLabel for="movil" value="Movil: " />
                  <p:inputText id="movil" value="#{usuarioBean.usuario.movil}" required="false" style="width:100%">
                  </p:inputText>                
                  <p:message for="movil" id="msgMovil" display="icon" />

                  <h:outputLabel value="Estado: " />
                  <p:selectBooleanCheckbox id="estado" value="#{usuarioBean.conductor.estado}" />
                  <p:message for="estado" id="msgEstado" display="icon" />

                </h:panelGrid>
                <f:facet name="footer">
                  <center>
                    <p:commandButton ajax="true" oncomplete="cmdRefreshSolicitudes()" validateClient="true" value="Guardar" onclick="PF('newConductor').hide();"  action="#{usuarioBean.saveConductor()}" />
                  </center>
                </f:facet> 
              </p:panel>
            </center>
          </h:form>
        </p:dialog>
      </ui:define>
    </ui:composition>
  </h:body>
</html>
