<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets">

    <h:body>
        <ui:composition template="../templates/admin_template.xhtml">
            <ui:define name="main-body" >
                <h:form id="form-main-data">          
                   

                    <p:tabView id="tabview" dynamic="true" cache="false" effect="drop" effectDuration="fast" scrollable="true" >
                        <!-- ______________________MIS SOLICITUDES PENDIENTES_______________________ -->

                        <p:tab title="Mis Solicitudes Pendientes" id="tab2">

                            <p:dataTable id="table-solicitudes-pendientes" var="solicitud" value="#{solicitudBean.listaSolicitudesPendientes}" rowKey="#{solicitud}"
                                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         editable="true"  paginator="true" rows="20"   rowsPerPageTemplate="20,30,40,50,100,1000"
                                         widgetVar="solicitudPendienteTable"  emptyMessage="No se encontraron solicitudes pendientes." >

                                <p:ajax oncomplete="cmdRefreshSolicitudes()" event="rowEdit" listener="#{solicitudBean.onRowEdit}"/>
                                <p:ajax event="rowEditCancel" />

                                <p:column headerText="ID" sortBy="#{solicitud.id}" width="40">  
                                    <h:outputText value="#{solicitud.id}" />                  
                                </p:column>

                                <p:column width="80" filterBy="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" sortBy="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" headerText="Origen" filterMatchMode="contains" style="vertical-align: top;">  
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" />
                                            <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>                      
                                            <h:outputText value="#{solicitud.direccionOrigen}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />                      
                                        </f:facet>
                                        <f:facet name="input">                  
                                            <p:selectOneMenu filter="true" filterMatchMode="contains" id="origen" value="#{solicitud.distanciaById.localidadByIdOrigen.id}" style="width: 100%;">
                                                <f:selectItems value="#{solicitudBean.listaLocalidades}" />                    
                                            </p:selectOneMenu>
                                            <p:inputTextarea id="dorigen2" value="#{solicitud.direccionOrigen}" style="width:100%" />
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <p:column width="80" filterBy="#{solicitud.distanciaById.localidadByIdDestino.nombre}" sortBy="#{solicitud.distanciaById.localidadByIdDestino.nombre}" headerText="Destino" filterMatchMode="contains" style="vertical-align: top;">  
                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <h:outputText value="#{solicitud.distanciaById.localidadByIdDestino.nombre}" />
                                            (<h:outputText value="#{solicitud.distanciaById.distancia}" />)
                                            <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>                      
                                            <h:outputText value="#{solicitud.direccionDestino}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />                      
                                        </f:facet>
                                        <f:facet name="input">                  
                                            <p:selectOneMenu filter="true" filterMatchMode="contains" id="destino" value="#{solicitud.distanciaById.localidadByIdDestino.id}" style="width: 100%;">
                                                <f:selectItems value="#{solicitudBean.listaLocalidades}" />                    
                                            </p:selectOneMenu>
                                            <p:inputTextarea id="ddestino2" value="#{solicitud.direccionDestino}" style="width:100%" />
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <p:column headerText="Fechas" sortBy="#{solicitud.FSalida}" style="vertical-align: top;" > 

                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <span style="font-weight: 600;">Salida: </span>
                                            <h:outputText value="#{solicitud.FSalida}">
                                                <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                            </h:outputText>
                                            <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>                      
                                            <span style="font-weight: 600;">Llegada: </span>
                                            <h:outputText value="#{solicitud.FLlegada}">
                                                <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                            </h:outputText>

                                            <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>                      
                                            <span style="font-weight: 600;">Retorno: </span>
                                            <h:outputText value="#{solicitud.FRetorno}" rendered="#{solicitud.retorno}">
                                                <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                            </h:outputText>
                                            <div style="font-size: 11.5px; color: dimgrey;"></div>
                                            <h:outputText value="#{solicitud.retornoObservacion}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" rendered="#{solicitud.retorno}" /> 

                                            <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 10px;"></div>                      
                                            <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">Creado el: </span>
                                            <h:outputText value="#{solicitud.FCreacion}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">
                                                <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                            </h:outputText>
                                            <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> por: </span> 
                                            <h:outputText value="#{solicitud.usuarioByIdUsuarioSolicita.nombrecompleto}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                            <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                            <h:outputText value="#{solicitud.usuarioByIdUsuarioSolicita.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                            <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                        </f:facet>
                                        <f:facet name="input"> 
                                            <span style="font-weight: 600;">Salida: </span>
                                            <p:calendar id="fsalida" value="#{solicitud.FSalida}" pattern="MM/dd/yyyy HH:mm" />
                                            <span style="font-weight: 600;">Llegada: </span>
                                            <p:calendar id="fllegada" value="#{solicitud.FLlegada}" pattern="MM/dd/yyyy HH:mm" />
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <p:column headerText="Acompañantes" width="200" style="vertical-align: top;">  

                                    <p:cellEditor>
                                        <f:facet name="output">
                                            <span style="font-weight: 600;">Internos: </span>
                                            <p:dataList value="#{solicitud.listaInternosSeleccionados}"   var="usuario" type="definition"  emptyMessage="Ninguno">
                                                - #{usuario.nombrecompleto}
                                            </p:dataList>
                                            
                                            
                                            <div style="font-style: italic">Retorno: </div>
                                            <p:dataList value="#{solicitud.listaInternosSeleccionados_retorno}"   var="usuario" type="definition"  emptyMessage="-" rendered="#{solicitud.retorno}">
                                                - #{usuario.nombrecompleto}
                                            </p:dataList>
                                            
                                            
                                            
                                            <span style="font-weight: 600;">Externos: </span>
                                            <p:dataList value="#{solicitud.listaExternosSeleccionados}"  var="usuario" type="definition" emptyMessage="Ninguno">
                                                - #{usuario.nombrecompleto}
                                            </p:dataList>
                                            
                                            <div style="font-style: italic">Retorno: </div>
                                            <p:dataList value="#{solicitud.listaExternosSeleccionados_retorno}"   var="usuario" type="definition"  emptyMessage="-" rendered="#{solicitud.retorno}">
                                                - #{usuario.nombrecompleto}
                                            </p:dataList>
                                        </f:facet>
                                        <f:facet name="input"> 
                                            <span style="font-weight: 600;">Internos: </span>
                                            <p:autoComplete forceSelection="true" id="internos-in" multiple="true" value="#{solicitud.listaInternosSeleccionados}" completeMethod="#{solicitudBean.completeUsuarioInterno}"
                                                            var="usuario" itemLabel="#{usuario.nombrecompleto}" itemValue="#{usuario}" cache="true"
                                                            maxResults="10" minQueryLength="2" queryDelay="500" 
                                                            converter="usuarioInternoConverter" />
                                            <span style="font-weight: 600;">Externos: </span>
                                            <p:autoComplete forceSelection="true" id="internos-out" multiple="true" value="#{solicitud.listaExternosSeleccionados}" completeMethod="#{solicitudBean.completeUsuarioExterno}"
                                                            var="usuario" itemLabel="#{usuario.nombrecompleto}" itemValue="#{usuario}" cache="true"
                                                            maxResults="10" minQueryLength="2" queryDelay="500" 
                                                            converter="usuarioExternoConverter" />
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <p:column filterBy="#{solicitud.novedades}"  headerText="Novedades" filterMatchMode="contains" style="vertical-align: top;">  
                                    <p:cellEditor>
                                        <f:facet name="output">                      
                                            <span class="solicitud-tipo #{solicitud.tipo_solicitud_legible}" style="font-weight: 600;">Tipo: </span> 
                                            <h:outputText value="#{solicitud.tipo_solicitud_legible}" style="font-size: 11.5px; margin-top: 5px;" />
                                            (<h:outputText value="#{solicitud.emergenciaById.nombre}" style="font-size: 11.5px; margin-top: 5px;" />)
                                            <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 10px;"></div>
                                            <h:outputText value="#{solicitud.novedades}" /></f:facet>
                                        <f:facet name="input">
                                            <p:inputTextarea id="novedades" value="#{solicitud.novedades}" style="width:100%">
                                            </p:inputTextarea>                
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <p:column headerText="Estado" style="vertical-align: top;">                    
                                    <span style="font-weight: 600;">Enfermería: </span>
                                    <h:outputText value="#{solicitud.estadoEnfermeria_legible }" />
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>                      
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioEnfermero.nombrecompleto}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioEnfermero.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                </p:column>

                                <p:column filterBy="#{solicitud.usuarioByIdUsuarioConductor.apellido}" sortBy="#{solicitud.usuarioByIdUsuarioConductor.apellido}" headerText="Conductor" filterMatchMode="contains" style="vertical-align: top;">  
                                    <span style="font-weight: 600;">1: </span>
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor.nombrecompleto}" />
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>  
                                    <span style="font-weight: 600;">2: </span>
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor2.nombrecompleto}" />
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor2.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                </p:column>

                                <p:column style="width:50px"> 
                                    <p:rowEditor id="editrow" /> 
                                </p:column> 
                            </p:dataTable>  

                        </p:tab>

                        <!-- _________________________MIS SOLICITUDES APROBADAS________________ -->

                        <p:tab title="Mis Solicitudes Aprobadas" id="tab3">

                            <p:dataTable id="table-solicitudes-aprobadas" var="solicitud" value="#{solicitudBean.listaSolicitudesAprobadas}" rowKey="#{solicitud}"
                                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         editable="true"  paginator="true" rows="20"   rowsPerPageTemplate="20,30,40,50,100,1000"
                                         widgetVar="solicitudAprobadaTable"  emptyMessage="No se encontraron datos." >

                                <p:ajax oncomplete="cmdRefreshSolicitudes()" event="rowEdit" listener="#{solicitudBean.onRowEdit}"/>
                                <p:ajax event="rowEditCancel" />

                                <p:column headerText="ID" sortBy="#{solicitud.id}" width="40">  
                                    <h:outputText value="#{solicitud.id}" />                  
                                </p:column>

                                <p:column width="80" filterBy="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" sortBy="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" headerText="Origen" filterMatchMode="contains" style="vertical-align: top;">  

                                    <h:outputText value="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" />
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>                      
                                    <h:outputText value="#{solicitud.direccionOrigen}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />                      

                                </p:column>

                                <p:column width="80" filterBy="#{solicitud.distanciaById.localidadByIdDestino.nombre}" sortBy="#{solicitud.distanciaById.localidadByIdDestino.nombre}" headerText="Destino" filterMatchMode="contains" style="vertical-align: top;">  

                                    <h:outputText value="#{solicitud.distanciaById.localidadByIdDestino.nombre}" />
                                    (<h:outputText value="#{solicitud.distanciaById.distancia}" />)
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>                      
                                    <h:outputText value="#{solicitud.direccionDestino}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />

                                </p:column>

                                <p:column headerText="Fechas" sortBy="#{solicitud.FSalida}" style="vertical-align: top;"> 
                                    <span style="font-weight: 600;">Salida: </span>
                                    <h:outputText value="#{solicitud.FSalida}">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                    </h:outputText>
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>                      
                                    <span style="font-weight: 600;">Llegada: </span>
                                    <h:outputText value="#{solicitud.FLlegada}">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                    </h:outputText>

                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>                      
                                    <span style="font-weight: 600;">Retorno: </span>
                                    <h:outputText value="#{solicitud.FRetorno}" rendered="#{solicitud.retorno}">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                    </h:outputText>
                                    <div style="font-size: 11.5px; color: dimgrey;"></div>
                                    <h:outputText value="#{solicitud.retornoObservacion}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" rendered="#{solicitud.retorno}" /> 

                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 10px;"></div>                        
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">Creado el: </span>
                                    <h:outputText value="#{solicitud.FCreacion}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                    </h:outputText>
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> por: </span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioSolicita.nombrecompleto}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioSolicita.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                </p:column>

                                <p:column headerText="Acompañantes" width="200" style="vertical-align: top;">  
                                    <span style="font-weight: 600;">Internos: </span>
                                            <p:dataList value="#{solicitud.listaInternosSeleccionados}"   var="usuario" type="definition"  emptyMessage="Ninguno">
                                                - #{usuario.nombrecompleto}
                                            </p:dataList>
                                            
                                            
                                            <div style="font-style: italic">Retorno: </div>
                                            <p:dataList value="#{solicitud.listaInternosSeleccionados_retorno}"   var="usuario" type="definition"  emptyMessage="-" rendered="#{solicitud.retorno}">
                                                - #{usuario.nombrecompleto}
                                            </p:dataList>
                                            
                                            
                                            
                                            <span style="font-weight: 600;">Externos: </span>
                                            <p:dataList value="#{solicitud.listaExternosSeleccionados}"  var="usuario" type="definition" emptyMessage="Ninguno">
                                                - #{usuario.nombrecompleto}
                                            </p:dataList>
                                            
                                            <div style="font-style: italic">Retorno: </div>
                                            <p:dataList value="#{solicitud.listaExternosSeleccionados_retorno}"   var="usuario" type="definition"  emptyMessage="-" rendered="#{solicitud.retorno}">
                                                - #{usuario.nombrecompleto}
                                            </p:dataList>
                                </p:column>

                                <p:column filterBy="#{solicitud.novedades}"  headerText="Novedades" filterMatchMode="contains" style="vertical-align: top;">  
                                    <p:cellEditor>
                                        <f:facet name="output">                      
                                            <span class="solicitud-tipo #{solicitud.tipo_solicitud_legible}" style="font-weight: 600;">Tipo: </span> 
                                            <h:outputText value="#{solicitud.tipo_solicitud_legible}" style="font-size: 11.5px; margin-top: 5px;" />
                                            (<h:outputText value="#{solicitud.emergenciaById.nombre}" style="font-size: 11.5px; margin-top: 5px;" />)
                                            <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 10px;"></div>
                                            <h:outputText value="#{solicitud.novedades}" /></f:facet>
                                        <f:facet name="input">
                                            <p:inputTextarea id="novedades" value="#{solicitud.novedades}" style="width:100%">
                                            </p:inputTextarea>                
                                        </f:facet>
                                    </p:cellEditor>
                                </p:column>

                                <p:column headerText="Estado" style="vertical-align: top;">                    
                                    <span style="font-weight: 600;">Enfermería: </span>
                                    <h:outputText value="#{solicitud.estadoEnfermeria_legible }" />
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>                      
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioEnfermero.nombrecompleto}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioEnfermero.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                </p:column>

                                <p:column headerText="Conductor" filterMatchMode="contains" style="vertical-align: top;">  
                                    <span style="font-weight: 600;">1: </span>
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor.nombrecompleto}" />
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>  
                                    <span style="font-weight: 600;">2: </span>
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor2.nombrecompleto}" />
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor2.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                </p:column>

                                <p:column style="width:50px"> 
                                    <p:rowEditor id="editrow" /> 
                                </p:column> 
                            </p:dataTable>  

                        </p:tab>

                        <!-- _________________________MIS SOLICITUDES CANCELADAS ________________ -->

                        <p:tab title="Mis Solicitudes Canceladas" id="tab4">

                            <p:dataTable id="table-solicitudes-canceladas" var="solicitud" value="#{solicitudBean.listaSolicitudesCanceladas}" rowKey="#{solicitud}"
                                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         paginator="true" rows="20"   rowsPerPageTemplate="20,30,40,50,100,1000"
                                         widgetVar="solicitudCanceladaTable"  emptyMessage="No se encontraron solicitudes canceladas." >


                                <p:column headerText="ID" sortBy="#{solicitud.id}" width="40">  
                                    <h:outputText value="#{solicitud.id}" />                  
                                </p:column>

                                <p:column width="80" filterBy="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" sortBy="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" headerText="Origen" filterMatchMode="contains" style="vertical-align: top;">  

                                    <h:outputText value="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" />
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>                      
                                    <h:outputText value="#{solicitud.direccionOrigen}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />                      

                                </p:column>

                                <p:column width="80" filterBy="#{solicitud.distanciaById.localidadByIdDestino.nombre}" sortBy="#{solicitud.distanciaById.localidadByIdDestino.nombre}" headerText="Destino" filterMatchMode="contains" style="vertical-align: top;">  

                                    <h:outputText value="#{solicitud.distanciaById.localidadByIdDestino.nombre}" />
                                    (<h:outputText value="#{solicitud.distanciaById.distancia}" />)
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>                      
                                    <h:outputText value="#{solicitud.direccionDestino}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />

                                </p:column>

                                <p:column headerText="Fechas" sortBy="#{solicitud.FSalida}" style="vertical-align: top;"> 
                                    <span style="font-weight: 600;">Salida: </span>
                                    <h:outputText value="#{solicitud.FSalida}">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                    </h:outputText>
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>                      
                                    <span style="font-weight: 600;">Llegada: </span>
                                    <h:outputText value="#{solicitud.FLlegada}">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                    </h:outputText>

                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>                      
                                    <span style="font-weight: 600;">Retorno: </span>
                                    <h:outputText value="#{solicitud.FRetorno}" rendered="#{solicitud.retorno}">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                    </h:outputText>
                                    <div style="font-size: 11.5px; color: dimgrey;"></div>
                                    <h:outputText value="#{solicitud.retornoObservacion}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" rendered="#{solicitud.retorno}" /> 

                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 10px;"></div>                        
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">Creado el: </span>
                                    <h:outputText value="#{solicitud.FCreacion}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                    </h:outputText>
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> por: </span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioSolicita.nombrecompleto}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioSolicita.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                </p:column>

                                <p:column headerText="Acompañantes" width="200" style="vertical-align: top;">  
                                    <span style="font-weight: 600;">Internos: </span>
                                    <p:dataList value="#{solicitud.listaInternosSeleccionados}"   var="usuario" type="definition"  emptyMessage="Ninguno">
                                        - #{usuario.nombrecompleto}
                                    </p:dataList>


                                    <div style="font-style: italic">Retorno: </div>
                                    <p:dataList value="#{solicitud.listaInternosSeleccionados_retorno}"   var="usuario" type="definition"  emptyMessage="-" rendered="#{solicitud.retorno}">
                                        - #{usuario.nombrecompleto}
                                    </p:dataList>



                                    <span style="font-weight: 600;">Externos: </span>
                                    <p:dataList value="#{solicitud.listaExternosSeleccionados}"  var="usuario" type="definition" emptyMessage="Ninguno">
                                        - #{usuario.nombrecompleto}
                                    </p:dataList>

                                    <div style="font-style: italic">Retorno: </div>
                                    <p:dataList value="#{solicitud.listaExternosSeleccionados_retorno}"   var="usuario" type="definition"  emptyMessage="-" rendered="#{solicitud.retorno}">
                                        - #{usuario.nombrecompleto}
                                    </p:dataList>
                                </p:column>

                                <p:column filterBy="#{solicitud.novedades}"  headerText="Novedades" filterMatchMode="contains" style="vertical-align: top;">  
                                    <span class="solicitud-tipo #{solicitud.tipo_solicitud_legible}" style="font-weight: 600;">Tipo: </span> 
                                    <h:outputText value="#{solicitud.tipo_solicitud_legible}" style="font-size: 11.5px; margin-top: 5px;" />
                                    (<h:outputText value="#{solicitud.emergenciaById.nombre}" style="font-size: 11.5px; margin-top: 5px;" />)
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 10px;"></div>
                                    <h:outputText value="#{solicitud.novedades}" />                    
                                </p:column>

                                <p:column headerText="Estado" style="vertical-align: top;">  
                                    <span style="font-weight: 600;">Cancelado: Si </span>
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioEnfermero.nombrecompleto}" style="font-size: 11.5px; color: dimgrey;" />   
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioEnfermero.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>  

                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>  
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">Enfermería: </span>
                                    <h:outputText value="#{solicitud.estadoEnfermeria_legible }" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>                      
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioEnfermero.nombrecompleto}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />
                                </p:column>

                                <p:column filterBy="#{solicitud.usuarioByIdUsuarioConductor.apellido}" sortBy="#{solicitud.usuarioByIdUsuarioConductor.apellido}" headerText="Conductor" filterMatchMode="contains" style="vertical-align: top;">  
                                    <span style="font-weight: 600;">1: </span>
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor.nombrecompleto}" />
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>  
                                    <span style="font-weight: 600;">2: </span>
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor2.nombrecompleto}" />
                                </p:column>

                            </p:dataTable>  

                        </p:tab>

                        <!-- _________________________MIS SOLICITUDES DE EMERGENCIA ________________ -->

                        <p:tab title="Mis Solicitudes de Emergencia" id="tab5">

                            <p:dataTable id="table-solicitudes-emergencias" var="solicitud" value="#{solicitudBean.listaSolicitudesEmergencias}" rowKey="#{solicitud}"
                                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         editable="true"  paginator="true" rows="20"   rowsPerPageTemplate="20,30,40,50,100,1000"
                                         widgetVar="solicitudEmergenciaTable"  emptyMessage="No se encontraron datos." >

                                <p:column headerText="ID" sortBy="#{solicitud.id}" width="40">  
                                    <h:outputText value="#{solicitud.id}" />                  
                                </p:column>

                                <p:column width="80" filterBy="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" sortBy="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" headerText="Origen" filterMatchMode="contains" style="vertical-align: top;">  

                                    <h:outputText value="#{solicitud.distanciaById.localidadByIdOrigen.nombre}" />
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>                      
                                    <h:outputText value="#{solicitud.direccionOrigen}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />                      

                                </p:column>

                                <p:column width="80" filterBy="#{solicitud.distanciaById.localidadByIdDestino.nombre}" sortBy="#{solicitud.distanciaById.localidadByIdDestino.nombre}" headerText="Destino" filterMatchMode="contains" style="vertical-align: top;">  

                                    <h:outputText value="#{solicitud.distanciaById.localidadByIdDestino.nombre}" />
                                    (<h:outputText value="#{solicitud.distanciaById.distancia}" />)
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>                      
                                    <h:outputText value="#{solicitud.direccionDestino}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />

                                </p:column>

                                <p:column headerText="Fechas" sortBy="#{solicitud.FSalida}" style="vertical-align: top;"> 
                                    <span style="font-weight: 600;">Salida: </span>
                                    <h:outputText value="#{solicitud.FSalida}">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                    </h:outputText>
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>                      
                                    <span style="font-weight: 600;">Llegada: </span>
                                    <h:outputText value="#{solicitud.FLlegada}">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                    </h:outputText>

                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>                      
                                    <span style="font-weight: 600;">Retorno: </span>
                                    <h:outputText value="#{solicitud.FRetorno}" rendered="#{solicitud.retorno}">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                    </h:outputText>
                                    <div style="font-size: 11.5px; color: dimgrey;"></div>
                                    <h:outputText value="#{solicitud.retornoObservacion}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" rendered="#{solicitud.retorno}" /> 

                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 10px;"></div>                       
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">Creado el: </span>
                                    <h:outputText value="#{solicitud.FCreacion}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm" timeZone="GMT-5" />
                                    </h:outputText>
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> por: </span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioSolicita.nombrecompleto}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioSolicita.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                </p:column>

                                <p:column headerText="Acompañantes" width="200" style="vertical-align: top;">  
                                    <span style="font-weight: 600;">Internos: </span>
                                    <p:dataList value="#{solicitud.listaInternosSeleccionados}"   var="usuario" type="definition"  emptyMessage="Ninguno">
                                        - #{usuario.nombrecompleto}
                                    </p:dataList>


                                    <div style="font-style: italic">Retorno: </div>
                                    <p:dataList value="#{solicitud.listaInternosSeleccionados_retorno}"   var="usuario" type="definition"  emptyMessage="-" rendered="#{solicitud.retorno}">
                                        - #{usuario.nombrecompleto}
                                    </p:dataList>



                                    <span style="font-weight: 600;">Externos: </span>
                                    <p:dataList value="#{solicitud.listaExternosSeleccionados}"  var="usuario" type="definition" emptyMessage="Ninguno">
                                        - #{usuario.nombrecompleto}
                                    </p:dataList>

                                    <div style="font-style: italic">Retorno: </div>
                                    <p:dataList value="#{solicitud.listaExternosSeleccionados_retorno}"   var="usuario" type="definition"  emptyMessage="-" rendered="#{solicitud.retorno}">
                                        - #{usuario.nombrecompleto}
                                    </p:dataList>
                                </p:column>

                                <p:column filterBy="#{solicitud.novedades}"  headerText="Novedades" filterMatchMode="contains" style="vertical-align: top;">  
                                    <span class="solicitud-tipo #{solicitud.tipo_solicitud_legible}" style="font-weight: 600;">Tipo: </span> 
                                    <h:outputText value="#{solicitud.tipo_solicitud_legible}" style="font-size: 11.5px; margin-top: 5px;" />
                                    (<h:outputText value="#{solicitud.emergenciaById.nombre}" style="font-size: 11.5px; margin-top: 5px;" />)
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 10px;"></div>
                                    <h:outputText value="#{solicitud.novedades}" />                    
                                </p:column>

                                <p:column headerText="Estado" style="vertical-align: top;">                                      
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">Enfermería: </span>
                                    <h:outputText value="#{solicitud.estadoEnfermeria_legible }" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd;"></div>                      
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioEnfermero.nombrecompleto}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" />
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioEnfermero.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                </p:column>

                                <p:column filterBy="#{solicitud.usuarioByIdUsuarioConductor.apellido}" sortBy="#{solicitud.usuarioByIdUsuarioConductor.apellido}" headerText="Conductor" filterMatchMode="contains" style="vertical-align: top;">  
                                    <span style="font-weight: 600;">1: </span>
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor.nombrecompleto}" />
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                    <div style="width: 100%; height: 2px; display: block; border-bottom: 1px dashed #dddddd; margin-top: 15px;"></div>  
                                    <span style="font-weight: 600;">2: </span>
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor2.nombrecompleto}" />
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;"> (</span> 
                                    <h:outputText value="#{solicitud.usuarioByIdUsuarioConductor2.movil}" style="font-size: 11.5px; color: dimgrey; margin-top: 5px;" /> 
                                    <span style="font-size: 11.5px; color: dimgrey; margin-top: 5px;">)</span> 
                                </p:column>
                            </p:dataTable>  

                        </p:tab>

                        <!-- __________LOCALIDADES__________ -->

                        <p:tab title="Localidades" id="tablocalidades">
                            <p:layout  >
                                <p:layoutUnit id="origen-wrapper" position="west" size="600" header="LISTA CIUDAD DE ORIGEN (Seleccione una ciudad dando Click en el ID)" resizable="true" >

                                    <p:dataTable selection="#{localidadBean.localidadSeleccionada}" selectionMode="single" id="table-localidades" var="localidad" value="#{localidadBean.listaLocalidades}" rowKey="#{localidad.id}"                               
                                                 editable="true" widgetVar="localidadTable"  emptyMessage="No se encontraron datos." >

                                        <p:ajax event="rowEdit" listener="#{localidadBean.onRowEdit}" oncomplete="cmdRefreshSolicitudes()"/>
                                        <p:ajax event="rowEditCancel" listener="#{localidadBean.onRowCancel}" />                    
                                        <p:ajax event="rowSelect" listener="#{localidadBean.onRowSelect}"  update=":form-main-data:tabview:table-distancias" /> 

                                        <p:column headerText="ID" width="50">  
                                            <h:outputText value="#{localidad.id}" />
                                        </p:column>

                                        <p:column headerText="Nombre">  
                                            <p:cellEditor>
                                                <f:facet name="output"><h:outputText value="#{localidad.nombre}" /></f:facet>
                                                <f:facet name="input">
                                                    <p:inputText id="loc_nombre" value="#{localidad.nombre}" style="width:100%" required="true">                        
                                                        <p:ajax update="msgLoc_nombre" event="blur" />
                                                    </p:inputText>                
                                                    <p:message for="loc_nombre" id="msgLoc_nombre" display="icon" />
                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>

                                        <p:column style="width:50px">                   
                                            <p:rowEditor id="editrow" /> 
                                        </p:column> 
                                    </p:dataTable>  
                                </p:layoutUnit>
                                <p:layoutUnit id="destino-wrapper" position="center" header="EDITAR DISTANCIA DESTINO (Click en la distancia actual para Editar y terminar con Enter.)">
                                    <p:dataTable id="table-distancias" var="distancia" value="#{localidadBean.listaEditarDistancia}" rowKey="#{localidad.id}"
                                                 editable="true" editMode="cell" widgetVar="distanciaTable"  emptyMessage="Seleccione una ciudad haciendo Click en el ID." >

                                        <p:ajax event="cellEdit" listener="#{localidadBean.onCellEdit}"/>

                                        <p:column headerText="Nombre">  
                                            <h:outputText value="#{distancia.nombre}" />
                                        </p:column>

                                        <p:column headerText="Distancia" > 
                                            <p:cellEditor>
                                                <f:facet name="output">
                                                    <h:outputText value="#{distancia.distancia}" />
                                                </f:facet>
                                                <f:facet name="input">
                                                    <p:inputText value="#{distancia.distancia}" />                             
                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>


                                    </p:dataTable>
                                </p:layoutUnit>
                            </p:layout>

                        </p:tab>


                    </p:tabView>
                </h:form>  

                <!-- ________________________   NEW SOLICITUD FORM  ________________________   -->

                <p:dialog dynamic="true" closable="true" widgetVar="newSolicitud" header="Ingrese los datos de la Nueva Solicitud"  closeOnEscape="true" draggable="false" resizable="false" showEffect="drop" hideEffect="drop">
                    <h:form id="form-new-solicitud">    
                      <p:growl id="msgs" showDetail="true" />
                        <center>
                            <p:panel id="pn6" style="margin-bottom:10px;">
                                <p:messages id="messages" />
                                <h:panelGrid id="grid" columns="4" cellpadding="5">

                                    <h:outputLabel for="origen" value="Origen: *" />
                                    <p:selectOneMenu filter="true" filterMatchMode="contains" id="origen" value="#{solicitudBean.solicitud.distanciaById.localidadByIdOrigen.id}" style="width: 100%;">
                                        <f:selectItems value="#{solicitudBean.listaLocalidades}" />                    
                                    </p:selectOneMenu>


                                    <h:outputLabel for="dorigen" value="Dirección origen: *" />
                                    <p:inputTextarea id="dorigen" value="#{solicitudBean.solicitud.direccionOrigen}" style="width:100%">
                                    </p:inputTextarea>                


                                    <h:outputLabel for="destino" value="Destino: *" />
                                    <p:selectOneMenu filter="true" filterMatchMode="contains" id="destino" value="#{solicitudBean.solicitud.distanciaById.localidadByIdDestino.id}" style="width: 100%;" required="true" requiredMessage="Seleccione Destino">
                                        <f:selectItems value="#{solicitudBean.listaLocalidades}" />                    
                                    </p:selectOneMenu>


                                    <h:outputLabel for="ddestino" value="Dirección destino: *" />
                                    <p:inputTextarea id="ddestino" value="#{solicitudBean.solicitud.direccionDestino}" style="width:100%" requiredMessage="Ingrese Dirección Destino">
                                    </p:inputTextarea>                


                                    <h:outputLabel for="fsalida" value="Fecha y Hora de salida: *" />
                                    <p:calendar id="fsalida" value="#{solicitudBean.solicitud.FSalida}" pattern="MM/dd/yyyy HH:mm" stepMinute="5" mindate="#{solicitudBean.currentDate}" required="true" requiredMessage="Ingrese Fecha y Hora de Salida">
                                      <p:ajax event="dateSelect" listener="#{solicitudBean.onDateSelect}" update="fllegada,msgs" />                                       
                                    </p:calendar>


                                    <h:outputLabel for="fllegada" value="Fecha y Hora de llegada: *" />
                                    <p:calendar id="fllegada" value="#{solicitudBean.solicitud.FLlegada}" pattern="MM/dd/yyyy HH:mm" stepMinute="5" mindate="#{solicitudBean.solicitud.FSalida}" required="true" requiredMessage="Ingrese Fecha y Hora de llegada">
                                      <p:ajax event="dateSelect" listener="#{solicitudBean.onDateSelect}" update="msgs" />                                      
                                    </p:calendar>


                                    <p:outputLabel value="Acompañantes Internos: *" />
                                    <p:autoComplete forceSelection="true" placeholder="ninguno seleccionado" id="internos" multiple="true" value="#{solicitudBean.solicitud.listaInternosSeleccionados}" completeMethod="#{solicitudBean.completeUsuarioInterno}"
                                                    var="usuario" itemLabel="#{usuario.nombrecompleto}" itemValue="#{usuario}" cache="true"
                                                    maxResults="10" minQueryLength="2" queryDelay="500" 
                                                    converter="usuarioInternoConverter" />

                                    <p:outputLabel value="Acompañantes Externos: *" />
                                    <p:autoComplete forceSelection="true" placeholder="ninguno seleccionado" size="100" id="externos" multiple="true" value="#{solicitudBean.solicitud.listaExternosSeleccionados}" completeMethod="#{solicitudBean.completeUsuarioExterno}"
                                                    var="usuario" itemLabel="#{usuario.nombrecompleto}" itemValue="#{usuario}" cache="true"
                                                    maxResults="10" minQueryLength="2" queryDelay="500" 
                                                    converter="usuarioExternoConverter" />

                                    <h:outputLabel for="externo_nuevo" value="Nuevo acompañante Externo:" />
                                    <p:inputTextarea id="externo_nuevo" value="#{solicitudBean.solicitud.nuevoUsuarioExterno}" style="width: 100%;"
                                                     placeholder="Ejemplo: Juan Perez,Jose Duque,Carlos Ponce" />

                                    <h:outputLabel for="novedades" value="Novedades: " />
                                    <p:inputTextarea id="novedades" value="#{solicitudBean.solicitud.novedades}" style="width: 100%;" />                                 


                                    <br></br>
                                    <h:outputLabel value="POR FAVOR, NO SE OLVIDE DE COORDINAR EL HOSPEDAJE." style="color: darkred; border: 1px dotted darkred; padding: 7px; font-weight: bold;" />

                                </h:panelGrid>
                                <f:facet name="footer">
                                    <center>
                                        <h:commandButton value="Guardar" action="#{solicitudBean.saveSolicitud()}"   />
                                        <p:commandButton ajax="true" update=":form-edit-retorno" oncomplete="PF('editRetorno').show()" validateClient="true" value="Guardar y Editar Retorno" onclick="PF('newSolicitud').hide();"  action="#{solicitudBean.saveSolicitudyEditarRetorno()}" />
                                    </center>
                                </f:facet> 
                            </p:panel>
                        </center>
                    </h:form>
                </p:dialog>
                
                
                <!-- ________________________   EDITAR RETORNO FORM  ________________________   -->

                <p:dialog dynamic="true" closable="true" widgetVar="editRetorno" header="Edite el retorno"  closeOnEscape="true" draggable="false" resizable="false" showEffect="drop" hideEffect="drop">
                    <h:form id="form-edit-retorno">    
                      <p:growl id="msgs" showDetail="true" />
                        <center>
                            <p:panel id="pn2" style="margin-bottom:10px;">
                                <p:messages id="messages" />
                                <h:panelGrid id="grid" columns="2" cellpadding="5">

                                  <h:outputLabel for="fretorno" value="Fecha y Hora de Retorno: *" />
                                  <p:calendar id="fretorno" value="#{solicitudBean.solicitudRetorno.FRetorno}" pattern="MM/dd/yyyy HH:mm" stepMinute="5" mindate="#{solicitudBean.solicitudRetorno.FLlegada}" required="true" requiredMessage="Ingrese Fecha y Hora de Retorno">
                                  </p:calendar>

                                    <p:outputLabel value="Acompañantes Internos Retorno: *" />
                                    <p:autoComplete forceSelection="true" placeholder="ninguno seleccionado" id="internos" multiple="true" value="#{solicitudBean.solicitudRetorno.listaInternosSeleccionados_retorno}" completeMethod="#{solicitudBean.completeUsuarioInterno}"
                                                    var="usuario" itemLabel="#{usuario.nombrecompleto}" itemValue="#{usuario}" cache="true"
                                                    maxResults="10" minQueryLength="2" queryDelay="500" 
                                                    converter="usuarioInternoConverter" />

                                    <p:outputLabel value="Acompañantes Externos Retorno: *" />
                                    <p:autoComplete forceSelection="true" placeholder="ninguno seleccionado" size="100" id="externos" multiple="true" value="#{solicitudBean.solicitudRetorno.listaExternosSeleccionados_retorno}" completeMethod="#{solicitudBean.completeUsuarioExterno}"
                                                    var="usuario" itemLabel="#{usuario.nombrecompleto}" itemValue="#{usuario}" cache="true"
                                                    maxResults="10" minQueryLength="2" queryDelay="500" 
                                                    converter="usuarioExternoConverter" />

                                </h:panelGrid>
                                <f:facet name="footer">
                                    <center>                                      
                                      <p:commandButton ajax="true" oncomplete="cmdRefreshSolicitudes()" validateClient="true" value="Guardar" onclick="PF('editRetorno').hide();"  action="#{solicitudBean.saveSolicitudyDatosRetorno()}" />                                      
                                      <h:commandButton value="Cancelar" action="#{solicitudBean.cancelSolicitudyDatosRetorno()}" /> 
                                    </center>
                                </f:facet> 
                            </p:panel>
                        </center>
                    </h:form>
                </p:dialog>

                <!-- ________________________   NEW SOLICITUD EMERGENCIA FORM  ________________________   -->

                <p:dialog dynamic="true" widgetVar="newSolicitudEmergencia" header="Ingrese los datos de la Nueva Solicitud de Emergencia"  closeOnEscape="true" draggable="false" resizable="false" showEffect="drop" hideEffect="drop">
                    <h:form id="form-new-solicitud-emergencia">          
                      <p:growl id="msgs" showDetail="true" />
                        <center>
                            <p:panel id="pn2" style="margin-bottom:10px;">
                                <h:panelGrid id="grid" columns="4" cellpadding="5">

                                  <h:outputLabel for="origen" value="Origen: *" />
                                    <p:selectOneMenu filter="true" filterMatchMode="contains" id="origen" value="#{solicitudBean.solicitudEmergencia.distanciaById.localidadByIdOrigen.id}" style="width: 100%;">
                                        <f:selectItems value="#{solicitudBean.listaLocalidades}" />                    
                                    </p:selectOneMenu>


                                    <h:outputLabel for="dorigen" value="Dirección origen: *" />
                                    <p:inputTextarea id="dorigen" value="#{solicitudBean.solicitudEmergencia.direccionOrigen}" style="width:100%">
                                    </p:inputTextarea>                


                                    <h:outputLabel for="destino" value="Destino: *" />
                                    <p:selectOneMenu filter="true" filterMatchMode="contains" id="destino" value="#{solicitudBean.solicitudEmergencia.distanciaById.localidadByIdDestino.id}" style="width: 100%;" required="true" requiredMessage="Seleccione Destino">
                                        <f:selectItems value="#{solicitudBean.listaLocalidades}" />                    
                                    </p:selectOneMenu>


                                    <h:outputLabel for="ddestino" value="Dirección destino: *" />
                                    <p:inputTextarea id="ddestino" value="#{solicitudBean.solicitudEmergencia.direccionDestino}" style="width:100%" requiredMessage="Ingrese Dirección Destino">
                                    </p:inputTextarea>                

                                    <h:outputLabel for="fsalida" value="Fecha y Hora de salida: *" />
                                    <p:calendar id="fsalida" value="#{solicitudBean.solicitudEmergencia.FSalida}" pattern="MM/dd/yyyy HH:mm" stepMinute="5" mindate="#{solicitudBean.currentDate}" required="true" requiredMessage="Ingrese Fecha y Hora de Salida">
                                      <p:ajax event="dateSelect" update="fllegada" />                                       
                                    </p:calendar>


                                    <h:outputLabel for="fllegada" value="Fecha y Hora de llegada: *" />
                                    <p:calendar id="fllegada" value="#{solicitudBean.solicitudEmergencia.FLlegada}" pattern="MM/dd/yyyy HH:mm" stepMinute="5" mindate="#{solicitudBean.solicitudEmergencia.FSalida}" required="true" requiredMessage="Ingrese Fecha y Hora de llegada">
                                      
                                    </p:calendar>


                                    <p:outputLabel value="Acompañantes Internos: *" />
                                    <p:autoComplete forceSelection="true" placeholder="ninguno seleccionado" id="internos" multiple="true" value="#{solicitudBean.solicitudEmergencia.listaInternosSeleccionados}" completeMethod="#{solicitudBean.completeUsuarioInterno}"
                                                    var="usuario" itemLabel="#{usuario.nombrecompleto}" itemValue="#{usuario}" cache="true"
                                                    maxResults="10" minQueryLength="2" queryDelay="500" 
                                                    converter="usuarioInternoConverter" />

                                    <p:outputLabel value="Acompañantes Externos: *" />
                                    <p:autoComplete forceSelection="true" placeholder="ninguno seleccionado" size="100" id="externos" multiple="true" value="#{solicitudBean.solicitudEmergencia.listaExternosSeleccionados}" completeMethod="#{solicitudBean.completeUsuarioExterno}"
                                                    var="usuario" itemLabel="#{usuario.nombrecompleto}" itemValue="#{usuario}" cache="true"
                                                    maxResults="10" minQueryLength="2" queryDelay="500" 
                                                    converter="usuarioExternoConverter" />

                                    <h:outputLabel for="externo_nuevo" value="Nuevo acompañante Externo:" />
                                    <p:inputTextarea id="externo_nuevo" value="#{solicitudBean.solicitudEmergencia.nuevoUsuarioExterno}" style="width: 100%;"
                                                     placeholder="Ejemplo: Juan Perez,Jose Duque,Carlos Ponce" />

                                    <h:outputLabel for="novedades" value="Novedades: " />
                                    <p:inputTextarea id="novedades" value="#{solicitudBean.solicitudEmergencia.novedades}" style="width: 100%;" />                                 


                                    <h:outputLabel for="emergencia" value="Tipo de emergencia: *" />
                                    <p:selectOneMenu filter="true" filterMatchMode="contains" id="emergencia" value="#{solicitudBean.solicitudEmergencia.emergenciaById.id}" style="width: 100%;">
                                        <f:selectItems value="#{solicitudBean.listaEmergencia}" />                    
                                    </p:selectOneMenu>


                                    <br></br> 
                                    <h:outputLabel value="POR FAVOR, NO SE OLVIDE DE COORDINAR EL HOSPEDAJE." style="color: darkred; border: 1px dotted darkred; padding: 7px; font-weight: bold;" />

                                </h:panelGrid>
                                <f:facet name="footer">
                                    <center>
                                        <h:commandButton value="Guardar" action="#{solicitudBean.saveSolicitudEmergencia()}" />
                                        <p:commandButton ajax="true" update=":form-edit-emergencia-retorno" oncomplete="PF('editEmergenciaRetorno').show()" validateClient="true" value="Guardar y Editar Retorno" onclick="PF('newSolicitudEmergencia').hide();"  action="#{solicitudBean.saveSolicitudEmergenciayEditarRetorno()}" />
                                    </center>
                                </f:facet> 
                            </p:panel>
                        </center>
                    </h:form>
                </p:dialog>
                
                <!-- ________________________   EDITAR RETORNO FORM  ________________________   -->

                <p:dialog dynamic="true" closable="true" widgetVar="editEmergenciaRetorno" header="Edite el retorno (Emergencia)"  closeOnEscape="true" draggable="false" resizable="false" showEffect="drop" hideEffect="drop">
                    <h:form id="form-edit-emergencia-retorno">    
                      <p:growl id="msgs" showDetail="true" />
                        <center>
                            <p:panel id="pn2" style="margin-bottom:10px;">
                                <p:messages id="messages" />
                                <h:panelGrid id="grid" columns="2" cellpadding="5">

                                  <h:outputLabel for="fretorno" value="Fecha y Hora de Retorno: *" />
                                  <p:calendar id="fretorno" value="#{solicitudBean.solicitudEmergenciaRetorno.FRetorno}" pattern="MM/dd/yyyy HH:mm" stepMinute="5" mindate="#{solicitudBean.solicitudEmergenciaRetorno.FLlegada}" required="true" requiredMessage="Ingrese Fecha y Hora de Retorno">
                                  </p:calendar>

                                    <p:outputLabel value="Acompañantes Internos Retorno: *" />
                                    <p:autoComplete forceSelection="true" placeholder="ninguno seleccionado" id="internos" multiple="true" value="#{solicitudBean.solicitudEmergenciaRetorno.listaInternosSeleccionados_retorno}" completeMethod="#{solicitudBean.completeUsuarioInterno}"
                                                    var="usuario" itemLabel="#{usuario.nombrecompleto}" itemValue="#{usuario}" cache="true"
                                                    maxResults="10" minQueryLength="2" queryDelay="500" 
                                                    converter="usuarioInternoConverter" />

                                    <p:outputLabel value="Acompañantes Externos Retorno: *" />
                                    <p:autoComplete forceSelection="true" placeholder="ninguno seleccionado" size="100" id="externos" multiple="true" value="#{solicitudBean.solicitudEmergenciaRetorno.listaExternosSeleccionados_retorno}" completeMethod="#{solicitudBean.completeUsuarioExterno}"
                                                    var="usuario" itemLabel="#{usuario.nombrecompleto}" itemValue="#{usuario}" cache="true"
                                                    maxResults="10" minQueryLength="2" queryDelay="500" 
                                                    converter="usuarioExternoConverter" />

                                </h:panelGrid>
                                <f:facet name="footer">
                                    <center>                                      
                                      <p:commandButton ajax="true" oncomplete="cmdRefreshSolicitudes()" validateClient="true" value="Guardar" onclick="PF('editEmergenciaRetorno').hide();"  action="#{solicitudBean.saveSolicitudEmergenciayDatosRetorno()}" />                                      
                                      <h:commandButton value="Cancelar" action="#{solicitudBean.cancelSolicitudyDatosRetorno()}" /> 
                                    </center>
                                </f:facet> 
                            </p:panel>
                        </center>
                    </h:form>
                </p:dialog>

                <!-- ________________________   NEW LOCALIDAD FORM  ________________________   -->

                <p:dialog dynamic="true" widgetVar="newLocalidad" header="Ingrese la nueva Localidad"  closeOnEscape="true" draggable="false" resizable="false" showEffect="drop" hideEffect="drop">
                    <h:form id="form-new-localidad">          
                        <center>
                            <p:panel id="pn2" style="margin-bottom:10px;">
                                <h:panelGrid id="grid2" columns="3" cellpadding="5">

                                    <h:outputLabel for="loc_nombre" value="Nombre *" />
                                    <p:inputText id="loc_nombre" value="#{localidadBean.localidad.nombre}" style="width:100%" required="true">                    
                                        <p:ajax update="msgLoc_nombre" event="blur" />
                                    </p:inputText>                
                                    <p:message for="loc_nombre" id="msgLoc_nombre" display="icon" />

                                </h:panelGrid>
                                <f:facet name="footer">
                                    <center>
                                        <p:commandButton ajax="true" oncomplete="cmdRefreshSolicitudes()" validateClient="true" value="Guardar" onclick="PF('newLocalidad').hide();"  action="#{localidadBean.saveLocalidad()}" />
                                    </center>
                                </f:facet> 
                            </p:panel>
                        </center>
                    </h:form>
                </p:dialog>

            </ui:define>
        </ui:composition>
    </h:body>
</html>
